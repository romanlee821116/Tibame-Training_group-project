<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q&A</title>
    <link rel="stylesheet" href="../css/n-faq.css">
</head>
<body>
    <div id="app">
        <header class="n-faq_header">
            <div class="n-faq_logo">
                <img src="../images/backend/n_logo.png" alt="" srcset="">
                <p>小春堂後臺管理</p>
            </div>
               
            <div class="n-faq_logout" @click='log_out'>
                <p>帳號登出</p>
                <img src="../images/backend/log-out.png" alt="" srcset="">
            </div>
        </header>

        <main class="n-faq_main">
            <div class="n-faq_left">
                <a v-for = 'btn in mainbtn' :href="btn.url">{{btn.name}}</a>
            </div>

            <div class="n-faq_right">

                <form action="" method="get" id="">
                    <p>Q&A</p>

                    <div class="n-faq_faqbtn">
                        <button class="n-faq_add" @click='new_add()' type="button">新增</button>
                    </div>
    
                    <section>
                        <input type="text" name="search" id="search" placeholder="以問題編號查詢" v-model='faq_number'>    
                        <label for="search" :class="{'-active':faq_number}">搜尋</label>
                    </section>
                </form>

                <div>
                    <ul class="n-faq_title">
                        <li v-for = 'title in titles'>{{title}}</li>
                        <li></li>
                    </ul>

                    <ul v-for='(faq,key) in faqs' class="n-faq_faq">                              
                        <li>{{faq.問題編號}}</li>
                        <li>{{f_sort_list[faq.問題分類]}}</li>
                        <li>{{faq.問題}}</li>
                        <li>{{faq.回答}}</li>
                        <li @click='edit(key)'>編輯與查看</li>
                    </ul>                
                </div>
            </div>
        </main>

        <footer class="n-faq_footer">
            <ul>
                <li v-for='page in pages'>{{page.page}}</li>
            </ul>
        </footer>

        <div class="n-faq_edit" v-if='current_edit !== null'>
        <!-- <div class="n-faq_edit" v-if='true'> -->

            <p>編輯與查看</p>            
           
            <ul>                    
                <li>
                    問題分類:
                    <select name="status" id="" v-model='f_sort'>
                        <option value="0">交易相關</option>
                        <option value="1">食材相關</option>
                        <option value="2">運送相關</option>
                    </select>
                    
                </li>                    

                <li>
                    <label for="">&emsp;&emsp;問題:</label>
                    <input type="text" v-model='f_question'>
                </li>

                
                <li>
                    <label for="">&emsp;&emsp;回答:</label>
                    <textarea name="" id="" cols="73" rows="8" v-model='f_answer'></textarea>
                </li>
            </ul>
            

            <div class="n-faq_editbtn">
                <button class="n-faq_close" @click='f_close'>關閉</button>
                <button class="n-faq_save" @click='f_save'>儲存</button>
            </div>

        </div>

        <div id="hide" v-if='current_edit !== null'></div>

        <faq-add v-if='new_edit' @fclose='closefff' @fsave='savefff'></faq-add>

    </div>

    <script src="../js/vue.js"></script>
    <script>
        Vue.component('faq-add', {
            data(){
                return{  //組件的變數寫在這裡
                    f_sort:0,
                    f_answer: '',
                    f_question: '',
                };
            },
            
            template: `
                <div>
                    <div class="n-faq_edit">

                        <p>編輯與查看</p>            
                    
                        <ul>                    
                            <li>
                                問題分類:
                                <select name="status" id="" v-model='f_sort'>
                                    <option value="0">交易相關</option>
                                    <option value="1">食材相關</option>
                                    <option value="2">運送相關</option>
                                </select>
                                
                            </li>                    

                            <li>
                                <label for="">&emsp;&emsp;問題:</label>
                                <input type="text" v-model='f_question'>
                            </li>

                            
                            <li>
                                <label for="">&emsp;&emsp;回答:</label>
                                <textarea name="" id="" cols="73" rows="8" v-model='f_answer'></textarea>
                            </li>
                        </ul>
                        

                        <div class="n-faq_editbtn">
                            <button class="n-faq_close" @click='f_close'>關閉</button>
                            <button class="n-faq_save" @click='f_save'>儲存</button>
                        </div>

                    </div>
                    <div id="hide"></div>
                </div>

            `,
            methods:{
                f_close(){ 
                    this.$emit('fclose');
                },  
                f_save(){   

                    this.$emit('fsave', this.f_sort, this.f_question, this.f_answer);

                },
            }  
        });



        new Vue({
            el: '#app',
            data:{
                faq_number:'',
                f_sort_list:['交易相關', '食材相關', '運送相關'],      
                f_sort:0,
                f_question:'',
                f_answer:'',
                new_edit:false,
                
                mainbtn: [  
                    {name:"會員管理", url: "./n-member.html"},
                    {name:"訂單管理", url: "./n-order.html"},
                    {name:"商品管理", url: "./n-product.html"},
                    {name:"客製化商品管理", url: "./n-customized.html"},
                    {name:"消息管理", url: "./n-news.html"},
                    {name:"折扣碼管理", url: "./n-discount.html"},
                    {name:"Q&A", url: "./n-faq.html"},
                ],
                titles: ['問題編號', '問題分類', '問題', '回答', ''],
                faqs:[
                    {
                        '問題編號':'1234567890',
                        '問題分類':0,
                        '問題':'1新品上市新品上市新品上市新品上市新品上市',
                        '回答':'1這就是回答',
                    },
                    {
                        '問題編號':'1234567890',
                        '問題分類':1,
                        '問題':'2新品上市新品上市新品上市新品上市新品上市',
                        '回答':'2這就是回答',
                    },
                    {
                        '問題編號':'1234567890',
                        '問題分類':2,
                        '問題':'3新品上市新品上市新品上市新品上市新品上市',
                        '回答':'3這就是回答',
                    }
                ],
                pages:[
                    {page:"<", url: "#"},
                    {page:"1", url: "#"},
                    {page:"2", url: "#"},
                    {page:"3", url: "#"},
                    {page:"4", url: "#"},
                    {page:"5", url: "#"},
                    {page:"...", url: "#"},
                    {page:"20", url: "#"},
                    {page:">", url: "#"},
                ],
                current_edit:null,
            },

            methods: {
                edit(index){                    
                    this.current_edit = index;  

                    this.f_sort = this.faqs[index].問題分類;
                    this.f_question = this.faqs[index].問題;
                    this.f_answer = this.faqs[index].回答;
                    
                },
                f_close(){                    
                    this.current_edit = null;
                },  
                f_save(){     

                    let n_index = this.$data.current_edit;

                    this.faqs[n_index].問題分類 = this.f_sort;
                    this.faqs[n_index].問題 = this.f_question;
                    this.faqs[n_index].回答 = this.f_answer;

                    this.current_edit = null;
                },
                new_add(){
                    this.new_edit = true;
                    // this.current_edit = "notnull";
                },
                closefff(){
                    this.new_edit = false;
                },
                savefff(f_sort, f_question, f_answer){
                    this.new_edit = false;

                    // console.log(f_sort);

                    let fff = 
                    {
                        '問題編號':'1234567890',
                        '問題分類':parseInt(f_sort),
                        '問題':f_question,
                        '回答':f_answer,
                    }

                    // console.log(fff);

                    this.faqs.unshift(fff);
                },
                log_out(){
                    location.href = "./n-login.html"
                }                
                
            },
            
        })
    </script>
</body>
</html>